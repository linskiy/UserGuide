## Тестирование Робокассы

Для тестирования Робокассы вам нужно иметь [аккаунт](https://partner.robokassa.ru/Reg/Register?culture=ru) в этой платежной системе, а так же настроить работу этой платежной системы в PricePlan. Так же вам необходимо ознакомится с [документацией Робокассы](http://robokassa.ru/ru/Doc/Ru/Interface.aspx).

[сюда нужно добавить краткую пошаговую инструкцию по заведению аккаунта Робокассы до момента получения `MerchantLogin`]

Для настройки интеграции Робокассы с PricePlan зайдите на страницу [настроек биллинга](https://cust1.priceplan.ru:7889/account/). На этой странице вы найдете раздел `Настройки Робокассы`.

Заполните следующие поля:
* `Логин от Робокассы` - ваши уникальный `Идентификатор магазина` (`MerchantLogin`).
* `Пароль от Робокассы 1` - платежный пароль #1.
* `Пароль от Робокассы 2` - платежный пароль #2.

Включите `Режим отладки`.

Поля `Result URL`, `Success URL`, `Fail URL` будут сгенерированы автоматически.

После того, как вы настроите интеграцию Робокассы в PricePlan, необходимо правильно настроить интеграцию вашего магазина в Робокассе. Для этого зайдите в личный кабинет, выберите магазин и перейдите на вкладку `Технические настройки`, на которой расположена форма с настройками. **Будьте внимательны при заполнении полей данной формы**. Заполните поля:

* `Идентификатор магазина` - уникальный идентификатор вашего магазина. 
* `Алгоритм расчета хеша` - MD5.
* `Result URL`, `Success URL` и `Fail URL` скопируйте значения из PricePlan.
* `Метод отсылки данных по Result Url`, `Метод отсылки данных по Success Url`, `Метод отсылки данных по Fail Url` - везде укажите POST.

Если вы только тестируете интеграцию с Робокассой, задайте пароли в форме `Параметры проведения тестовых платежей`, если же хотите перейти в рабочий режим, укажите пароли в основной форме. В любом случае платежный `Пароль #1`и `Пароль #2` должны совпадать с настройками в PricePlan.

После того как вы полностью настроили интеграцию с Робокассой, можно приступать к тестированию приема платежей. Для этого пройдите в личный кабинет пользователя и пополните его баланс. Для этого рядом с балансом пользователя нажмите на кнопку "Пополнить баланс". Появится форма пополнения счета. Выставите счет. Если у вас подключено больше одной платежной системы, вы увидите форму выбора с выпадающим списком. Если вы подключили только Робокассу, вас автоматически перенаправит на страницу оплаты этой платежной системы. На ней вы увидите общую информацию о платеже и кнопку `Оплатить`. По клику на кнопке вас должно отправить на страницу оплаты уже в платежной системе.

После успешной оплаты счета в Робокассе, вас должно перенаправить на страницу успешного платежа. Если в процессе оплаты произошла ошибка, вас перенаправит на страницу с сообщением об ошибке.

В случае успеха счет клиента должен быть пополнен на размер оплаченной вами суммы.

## Тестирование Яндекс.Кассы

Для тестирования Яндекс.Кассы вам нужно иметь [учетную запись](https://money.yandex.ru/joinups) в этой платежной системе, а так же настроить работу этой платежной системы в PricePlan. Так же вам необходимо ознакомится с [документацией](https://tech.yandex.ru/money/doc/dg/concepts/About-docpage/).

Для настройки интеграции Яндекс.Кассы с PricePlan зайдите на страницу [настроек биллинга](https://cust1.priceplan.ru:7889/account/). На этой странице вы найдете раздел `Настройки Яндекс.Кассы`.

Активируйте данную платежную систему и заполните следующие поля:
* Shop ID - уникальный идентификатор вашего магазина.
* scid - номер витрины.
* ShopPassword - пароль для верификации платежей.
* Режиме отладки.

После того, как вы настроите интеграцию Яндекс.Кассы в PricePlan, необходимо правильно настроить интеграцию вашего магазина в Яндекс.Кассе. Для этого зайдите в [личный кабинет](https://money.yandex.ru/my) во вкладку `Статус подключения` и настройте интеграцию по HTTP-протоколу:

* Скопируйте `checkURL`, `avisoURL`, `successURL`, `failURL` из настроек PricePlan.
* Установите галочку `Я буду проводить тестовые платежи`.
* Аналогично скопируйте `checkURL`, `avisoURL`, `successURL`, `failURL` из настроек PricePlan, как вы это уже сделали в первом пункте.
* Укажите `Email для отправки реестров`.
* Заполните `ShopPassword` - он должен совпадать с тем паролем, который вы указали в PricePlan.

После успешного заполнения формы, ваш запрос будет отправлен на модерацию Яндексом. После чего, через некоторое время, вам будет выслано почтовое уведомление с параметрами тестового режима. **Внимательно ознакомьтесь с ним.** `scid`, указанный вами в форме настроек PricePlan, может не совпадать с вашим текущим `scid`, указанным в личном кабинете. Для тестирования используйте `scid` высланный вам в письме.

После того как вы полностью настроили интеграцию с Яндекс.Кассой, можно приступать к тестированию приема платежей. Для этого пройдите в личный кабинет пользователя и пополните его баланс. Для этого рядом с балансом пользователя нажмите на кнопку "Пополнить баланс". Появится форма пополнения счета. Выставите счет. Если у вас подключено больше одной платежной системы, вы увидите форму выбора с выпадающим списком. Если вы подключили только Робокассу, вас автоматически перенаправит на страницу оплаты этой платежной системы. На ней вы увидите общую информацию о платеже и кнопку `Оплатить`. По клику на кнопке вас должно отправить на страницу оплаты уже в платежной системе.